{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/saidurrhman/mazhar_rony/mazhar_roney/mazhar_rony/app/api/meeting/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\n\ninterface MeetingInput {\n  name: string;\n  email: string;\n  date: string;\n  time: string;\n  timezone?: string;\n  duration: string;\n  context: string;\n}\n\nfunction validateInput(data: unknown): { valid: boolean; data?: MeetingInput; error?: string } {\n  if (!data || typeof data !== 'object') {\n    return { valid: false, error: 'Invalid request body' };\n  }\n\n  const input = data as Record<string, unknown>;\n\n  // Validate required fields\n  if (!input.name || typeof input.name !== 'string' || input.name.trim().length < 2) {\n    return { valid: false, error: 'Name must be at least 2 characters' };\n  }\n\n  if (!input.email || typeof input.email !== 'string') {\n    return { valid: false, error: 'Email is required' };\n  }\n\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  if (!emailRegex.test(input.email)) {\n    return { valid: false, error: 'Invalid email format' };\n  }\n\n  if (!input.date || typeof input.date !== 'string') {\n    return { valid: false, error: 'Date is required' };\n  }\n\n  if (!input.time || typeof input.time !== 'string') {\n    return { valid: false, error: 'Time is required' };\n  }\n\n  if (!input.context || typeof input.context !== 'string' || input.context.trim().length < 10) {\n    return { valid: false, error: 'Meeting context must be at least 10 characters' };\n  }\n\n  // Validate date is in the future\n  const selectedDate = new Date(input.date);\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  if (selectedDate < today) {\n    return { valid: false, error: 'Date must be in the future' };\n  }\n\n  return {\n    valid: true,\n    data: {\n      name: input.name.trim(),\n      email: input.email.trim(),\n      date: input.date,\n      time: input.time,\n      timezone: input.timezone ? String(input.timezone).trim() : undefined,\n      duration: input.duration ? String(input.duration) : '60min',\n      context: input.context.trim(),\n    },\n  };\n}\n\n// Simple rate limiting (in-memory, resets on server restart)\nconst rateLimitMap = new Map<string, { count: number; resetTime: number }>();\n\nfunction checkRateLimit(identifier: string): boolean {\n  const now = Date.now();\n  const record = rateLimitMap.get(identifier);\n\n  if (!record || now > record.resetTime) {\n    rateLimitMap.set(identifier, { count: 1, resetTime: now + 60000 }); // 1 minute window\n    return true;\n  }\n\n  if (record.count >= 3) {\n    return false;\n  }\n\n  record.count++;\n  return true;\n}\n\nexport async function POST(req: NextRequest) {\n  try {\n    // Get client IP for rate limiting\n    const forwarded = req.headers.get('x-forwarded-for');\n    const ip = forwarded ? forwarded.split(',')[0] : req.headers.get('x-real-ip') || 'unknown';\n\n    // Check rate limit\n    if (!checkRateLimit(ip)) {\n      return NextResponse.json(\n        { error: 'Too many requests. Please try again later.' },\n        { status: 429 }\n      );\n    }\n\n    // Parse and validate input\n    const body = await req.json();\n    const validation = validateInput(body);\n\n    if (!validation.valid || !validation.data) {\n      return NextResponse.json(\n        { error: validation.error || 'Invalid input' },\n        { status: 400 }\n      );\n    }\n\n    const { name, email, date, time, timezone, duration, context } = validation.data;\n\n    // Format email content\n    const emailSubject = `Meeting Request - ${name}`;\n    const emailBody = `\nNew Meeting Request\n\nName: ${name}\nEmail: ${email}\nPreferred Date: ${date}\nPreferred Time: ${time}\nTimezone: ${timezone || 'Not specified'}\nDuration: ${duration}\nMeeting Context:\n${context}\n\n---\nThis meeting request was submitted from the contact page at ${new Date().toISOString()}.\n    `.trim();\n\n    // In production, you would send this via an email service (Resend, SendGrid, etc.)\n    // For now, we'll return success and the client can use mailto as fallback\n    // You can integrate with an email service here:\n    // \n    // Example with Resend:\n    // await resend.emails.send({\n    //   from: 'contact@meetmazhar.site',\n    //   to: 'hello@meetmazhar.site',\n    //   subject: emailSubject,\n    //   text: emailBody,\n    // });\n\n    // Log the meeting request (in production, save to database)\n    if (process.env.NODE_ENV === 'development') {\n      console.log('Meeting Request:', {\n        name,\n        email,\n        date,\n        time,\n        timezone,\n        duration,\n        context,\n      });\n    }\n\n    return NextResponse.json(\n      {\n        success: true,\n        message: 'Meeting request received. You will receive a confirmation email shortly.',\n      },\n      { status: 200 }\n    );\n  } catch (err) {\n    if (process.env.NODE_ENV === 'development') {\n      console.error('Meeting API error:', err);\n    }\n\n    return NextResponse.json(\n      { error: 'Unable to process meeting request. Please try again later.' },\n      { status: 500 }\n    );\n  }\n}\n\n"],"names":[],"mappings":"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"}}]
}